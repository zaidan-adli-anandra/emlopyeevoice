<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EmployeeVoice â€“ Tickets</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Login Page -->
  <div id="loginPage" class="login-page">
    <div class="login-card">
      <div class="login-header">
        <img src="logoEV.png" alt="Logo" class="login-logo">
        <div class="login-title">Welcome Back</div>
        <div class="login-sub">Please sign in to continue</div>
      </div>
      <form id="loginForm" class="login-form">
        <label class="field">
          <span>Username</span>
          <input type="text" id="username" placeholder="e.g. dzikra or admin" required>
        </label>
        <label class="field">
          <span>Password</span>
          <input type="password" id="password" placeholder="Enter password" required>
        </label>
        <div id="loginError" class="error-msg">Invalid username or password</div>
        <button type="submit" class="btn primary" style="width:100%">Sign In</button>
      </form>
      <div style="text-align:center; font-size:12px; color:var(--muted); margin-top:10px;">
        Demo: <strong>dzikra</strong> / 123 &nbsp;|&nbsp; <strong>admin</strong> / 123
      </div>
    </div>
  </div>

  <div id="app" class="app" style="display:none;">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="user">
        <div class="avatar" id="userAvatar">DK</div>
        <div class="user-meta">
          <div id="userName" class="user-name">Dzikra Ksatria</div>
          <div id="userRole" style="font-size:12px; color:var(--muted)">Member</div>
        </div>
        <button id="btnLogout" class="icon-btn" style="width:32px; height:32px; margin-left:auto; border:0;" title="Logout">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
        </button>
      </div>
      <nav class="sidenav">
        <button class="nav-item active">
          <span class="nav-dot"></span> Dashboard
        </button>
        <button class="nav-item">
          <span class="nav-dot"></span> Progress
        </button>
        <button class="nav-item">
          <span class="nav-dot"></span> Settings
        </button>
        
      </nav>
    </aside>

    <!-- Main -->
    <main class="main">
      <header class="topbar">
        <div class="brand">
          <a class="brand-logo" href="#" aria-label="EmployeeVoice home">
            <img src="logoEV.png" alt="EmployeeVoice logo" />
          </a>
        </div>
      </header>

      <section class="content">
        <!-- User Toolbar -->
        <div class="toolbar" id="userToolbar">
          <div class="search">
            <span class="icon">ðŸ”Ž</span>
            <input id="searchInput" type="search" placeholder="Search my tickets..." />
          </div>
          <div class="toolbar-spacer"></div>
          <button id="btnCreate" class="btn primary">+ Create Ticket</button>
        </div>

        <!-- Admin Toolbar -->
        <div class="toolbar" id="adminToolbar" style="display:none;">
          <div class="search">
            <span class="icon">ðŸ”Ž</span>
            <input id="adminSearchInput" type="search" placeholder="Search tickets by id/title/owner..." />
          </div>
          <label class="select">
            <select id="adminFilterSelect">
              <option value="all">All Status</option>
              <option value="new">New</option>
              <option value="pending">Pending</option>
              <option value="overdue">Overdue</option>
            </select>
          </label>
          <div class="toolbar-spacer"></div>
          <button id="btnRefresh" class="btn ghost">Refresh</button>
        </div>

        <!-- User Ticket List -->
        <div id="myTickets" class="ticket-list">
          <!-- Populated by JS -->
        </div>

        <!-- Admin Ticket Table -->
        <div id="adminTickets" class="card" style="display:none;">
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Title</th>
                  <th>Category</th>
                  <th>Status</th>
                  <th>Priority</th>
                  <th>User</th>
                  <th>Age</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="adminTbody"></tbody>
            </table>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Create Modal -->
  <div class="modal" id="createModal">
    <div class="dialog" role="dialog" aria-modal="true">
      <header class="dialog-head">
        <div>Create Ticket</div>
        <button class="icon-btn close-modal" data-target="createModal">âœ•</button>
      </header>
      <form id="createForm" class="dialog-body">
        <label class="field">
          <span>Title</span>
          <input required name="title" placeholder="Issue title" />
        </label>
        <label class="field">
          <span>Category</span>
          <select required name="category">
            <option>Fasilitas</option>
            <option>Payroll / Benefit</option>
            <option>Conflict / Interpersonal</option>
            <option>Safety / K3</option>
            <option>HR / Admin</option>
          </select>
        </label>
        <label class="field span-2">
          <span>Description</span>
          <textarea required name="description" rows="4" placeholder="Describe the issue..."></textarea>
        </label>
        <label class="field" style="flex-direction:row; align-items:center; gap:8px;">
          <input type="checkbox" name="anonymous" style="width:auto; margin:0;">
          <span>Submit Anonymously</span>
        </label>
        <label class="field">
          <span>Priority</span>
          <select name="priority">
            <option>Low</option>
            <option selected>Medium</option>
            <option>High</option>
          </select>
        </label>
        <label class="field span-2">
          <span>Attachment (optional)</span>
          <input type="file" id="attachmentInput" accept=".png,.jpg,.jpeg,.pdf" />
          <div id="attachmentPreview" style="margin-top:8px; display:flex; gap:8px;"></div>
        </label>
      </form>
      <footer class="dialog-foot">
        <button class="btn ghost close-modal" data-target="createModal">Cancel</button>
        <button class="btn primary" id="submitTicket">Submit</button>
      </footer>
    </div>
  </div>

  <!-- Detail Modal -->
  <div class="modal" id="detailModal">
    <div class="dialog" role="dialog" aria-modal="true">
      <header class="dialog-head">
        <div id="detailTitle">Ticket</div>
        <button class="icon-btn close-modal" data-target="detailModal">âœ•</button>
      </header>
      <div class="dialog-body" style="display:block;">
        <div id="detailMeta" style="font-size:13px; color:var(--muted); margin-bottom:12px;"></div>
        <p id="detailDesc" style="margin-bottom:16px; line-height:1.5;"></p>
        <div id="detailAttachments" style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:16px;"></div>
        
        <hr style="border:0; border-top:1px solid var(--line); margin:16px 0;">
        
        <h4 style="font-size:14px; margin-bottom:12px;">Comments</h4>
        <ul id="commentsList" style="list-style:none; padding:0; margin:0 0 16px 0; display:flex; flex-direction:column; gap:12px;"></ul>
        
        <form id="commentForm" style="display:flex; gap:8px;">
          <input id="commentInput" placeholder="Add comment..." style="flex:1; border:1px solid var(--line); border-radius:10px; padding:8px 12px;">
          <button class="btn primary">Send</button>
        </form>
        
        <div style="margin-top:16px; font-size:12px; color:var(--muted);">
          Blocked / Pending Reason: <span id="detailBlocked">-</span>
        </div>

        <!-- Admin Controls -->
        <div id="adminControls" style="display:none; border-top:1px solid var(--line); padding-top:16px; margin-top:16px; grid-column: 1/-1; display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
          <label class="field">
            <span>Status</span>
            <select id="adminStatusSelect">
              <option>New</option>
              <option>In Progress</option>
              <option>Pending</option>
              <option>Resolved</option>
              <option>Closed</option>
            </select>
          </label>
          <label class="field">
            <span>Assignee</span>
            <input id="adminAssigneeInput" placeholder="Name" />
          </label>
          <label class="field span-2">
            <span>Blocked / Pending Reason</span>
            <input id="adminBlockedInput" />
          </label>
          <div class="span-2" style="display:flex; justify-content:flex-end;">
            <button id="btnAdminSave" class="btn primary">Save Changes</button>
          </div>
        </div>
      </div>
      <footer class="dialog-foot" style="justify-content: space-between;">
        <button class="btn ghost" id="btnDeleteTicket" style="color: #dc2626; border-color: #fecaca; background: #fef2f2;">Delete</button>
        <button class="btn ghost close-modal" data-target="detailModal">Close</button>
      </footer>
    </div>
  </div>

  <!-- Image Preview Modal -->
  <div class="modal" id="imageModal" style="background: rgba(0,0,0,0.9);">
    <div style="position: relative;">
      <button class="icon-btn close-modal" data-target="imageModal" style="position: absolute; top: -50px; right: 0; background: rgba(255,255,255,0.2); color: white; border: none;">âœ•</button>
      <img id="previewImage" src="" style="max-width: 90vw; max-height: 85vh; border-radius: 4px; display: block;">
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
